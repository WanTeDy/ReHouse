@using ReHouse.Utils
@using ReHouse.FrontEnd.Helpers
@using ReHouse.FrontEnd.Models
@using ReHouse.Utils.Helpers
@model ReHouse.FrontEnd.Models.LoadAdvertsForHomePageModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    var user = SessionHelpers.Session("user", typeof(SessionModel)) as SessionModel;
    var role = "";
    if (user != null)
    {
        role = user.Role.RussianName;
    }
}

@Scripts.Render("~/bundles/jcarousel")
@Scripts.Render("~/bundles/showDetails")
<script type="text/javascript">
    jQuery(document).ready(function () {
        jQuery('.d-carousel .carousel').jcarousel({
            scroll: 1,
        });
    });
</script>

<div class="slider-of-products">
    <div class="d-carousel" id="p">
        <h2>Горячие предложения</h2>
        <ul class="carousel">
            @foreach (var item in Model.HotAdverts)
            {
                <li>
                    @if (item.IsExclusive)
                    {
                        <div class="redimg"><img src="~/Content/images/eksklusiv.png"></div>
                    }
                    else if (item.IsHot)
                    {
                        <div class="redimg"><img src="~/Content/images/redcorner.png"></div>
                    }
                    else
                    {
                        <div class="redimg"><img src="~/Content/images/newred.png"></div>
                    }
                    @if (item.Type == ReHouse.Utils.Helpers.AdvertsType.Sale)
                    {                        
                        if (item.Images != null && item.Images.Count > 0)
                        {
                            <a class="fix" href="~/sale/detail/@item.Id"><img src="@Url.Content(item.Images[0].Url + item.Images[0].FileName)" width="250" height="212" alt="" /></a>
                        }
                        else
                        {
                            <a class="fix" href="~/sale/detail/@item.Id"><img src="~/Content/images/prod1.jpg" width="250" height="212" alt="" /></a>
                        }
                        <div class="min-content">
                            <div class="like" onclick="addtocart(@item.Id, '@item.Type', true, this);"></div>

                            @*<h3>Продам @item.Title.RussianName.ToLower()</h3>*@
                            <h3>@item.TitleName</h3>
                            <h4>@item.Description</h4>
                            <p class="cost">@item.Price $</p>
                            <a href="~/sale/detail/@item.Id" id="follow">❯</a>
                        </div>
                    }
                    else
                    {                        
                        if (item.Images != null && item.Images.Count > 0)
                        {
                            <a class="fix" href="~/rent/detail/@item.Id"><img src="@Url.Content(item.Images[0].Url + item.Images[0].FileName)" width="250" height="212" alt="" /></a>
                        }
                        else
                        {
                            <a class="fix" href="~/rent/detail/@item.Id"><img src="~/Content/images/prod1.jpg" width="250" height="212" alt="" /></a>
                        }
                        <div class="min-content">
                            <div class="like" onclick="addtocart(@item.Id, '@item.Type', true, this);"></div>
                            @*<h3>Сдам @item.Title.RussianName.ToLower()</h3>*@
                            <h3>@item.TitleName</h3>
                            <h4>@item.Description</h4>
                            <p class="cost">@item.Price грн/мес</p>
                            <a href="~/rent/detail/@item.Id" id="follow">❯</a>
                        </div>
                    }

                </li>
            }
        </ul>
        <a href="~/sale/flat" id="more">Подробнее</a>
    </div>
    <div class="streak"></div>

    <div class="d-carousel" id="p">
        <h2>Новострои</h2>
        <ul class="carousel">
            @foreach (var item in Model.NewBuildingAdverts)
            {
                <li>
                    @if (item.IsExclusive)
                    {
                        <div class="redimg"><img src="~/Content/images/eksklusiv.png"></div>
                    }
                    else if (item.IsHot)
                    {
                        <div class="redimg"><img src="~/Content/images/redcorner.png"></div>
                    }
                    else
                    {
                        <div class="redimg"><img src="~/Content/images/newred.png"></div>
                    }
                    @if (item.Images != null && item.Images.Count > 0)
                    {
                        <a class="fix" href="~/newbuilding/detail/@item.Id"><img src="@Url.Content(item.Images[0].Url + item.Images[0].FileName)" width="250" height="212" alt="" /></a>
                    }
                    else
                    {
                        <a class="fix" href="~/newbuilding/detail/@item.Id"><img src="~/Content/images/prod1.jpg" width="250" height="212" alt="" /></a>
                    }
                    <div class="min-content">
                        <div class="like" onclick="addtocart(@item.Id, '@AdvertsType.NewBuilding', true, this);"></div>
                        <h3>@item.Name</h3>
                        <h4>@item.Adress <br />Сдача: @item.ExpluatationDate.Name</h4>
                        <p class="cost">от @item.Price грн/м²</p>
                        <a href="~/newbuilding/detail/@item.Id" id="follow">❯</a>
                    </div>
                </li>
            }
        </ul>
        <a href="~/newbuilding/index" id="more">Подробнее</a>
    </div>
    <div class="streak"></div>

    <div class="d-carousel" id="p">
        <h2>Продажа квартир</h2>
        <ul class="carousel">
            @foreach (var item in Model.FlatSaleAdverts)
            {
                <li>
                    @if (item.IsExclusive)
                    {
                        <div class="redimg"><img src="~/Content/images/eksklusiv.png"></div>
                    }
                    else if (item.IsHot)
                    {
                        <div class="redimg"><img src="~/Content/images/redcorner.png"></div>
                    }
                    else
                    {
                        <div class="redimg"><img src="~/Content/images/newred.png"></div>
                    }
                    @if (item.Images != null && item.Images.Count > 0)
                    {
                        <a class="fix" href="~/sale/detail/@item.Id"><img src="@Url.Content(item.Images[0].Url + item.Images[0].FileName)" width="250" height="212" alt="" /></a>
                    }
                    else
                    {
                        <a class="fix" href="~/sale/detail/@item.Id"><img src="~/Content/images/prod1.jpg" width="250" height="212" alt="" /></a>
                    }
                    <div class="min-content">
                        <div class="like" onclick="addtocart(@item.Id, '@item.Type', true, this);"></div>
                        @*<h3>Продам @item.Title.RussianName.ToLower()</h3>*@
                        <h3>@item.TitleName</h3>
                        <h4>@item.Description</h4>
                        <p class="cost">@item.Price $</p>
                        <a href="~/sale/detail/@item.Id" id="follow">❯</a>
                    </div>
                </li>
            }

        </ul>
        <a href="~/sale/flat" id="more">Подробнее</a>
    </div>
    <div class="streak"></div>

    <div class="d-carousel" id="p">
        <h2>Продажа домов и участков</h2>
        <ul class="carousel">
            @foreach (var item in Model.HouseSaleAdverts)
            {
                <li>
                    @if (item.IsExclusive)
                    {
                        <div class="redimg"><img src="~/Content/images/eksklusiv.png"></div>
                    }
                    else if (item.IsHot)
                    {
                        <div class="redimg"><img src="~/Content/images/redcorner.png"></div>
                    }
                    else
                    {
                        <div class="redimg"><img src="~/Content/images/newred.png"></div>
                    }
                    @if (item.Images != null && item.Images.Count > 0)
                    {
                        <a class="fix" href="~/sale/detail/@item.Id"><img src="@Url.Content(item.Images[0].Url + item.Images[0].FileName)" width="250" height="212" alt="" /></a>
                    }
                    else
                    {
                        <a class="fix" href="~/sale/detail/@item.Id"><img src="~/Content/images/prod1.jpg" width="250" height="212" alt="" /></a>
                    }
                    <div class="min-content">
                        <div class="like" onclick="addtocart(@item.Id, '@item.Type', true, this);"></div>
                        @*<h3>Продам @item.Title.RussianName.ToLower()</h3>*@
                        <h3>@item.TitleName</h3>
                        <h4>@item.Description</h4>
                        <p class="cost">@item.Price $</p>
                        <a href="~/sale/detail/@item.Id" id="follow">❯</a>
                    </div>
                </li>
            }
        </ul>
        <a href="~/sale/house" id="more">Подробнее</a>
    </div>
</div>

<div class="news">
    <h2>Новости</h2>
    @foreach (var article in Model.Articles)
    {
        <div class="firstnews">
            <div class="img">
                @if (article.Images != null && article.Images.Count > 0)
                {
                    <img src="@Url.Content(article.Images[0].Url + article.Images[0].FileName)" width="440" height="263"/>
                }
                else
                {
                    <img src="~/Content/images/news1.jpg" width="440" height="263">
                }
            </div>
            <div class="content1">
                <h3>@article.Title</h3>
                @if (@article.Description.Length > 750)
                {
                    <p id="news_@article.Id">@article.Description.Substring(0, 749) ...</p>
                }
                else
                {
                    <p>@article.Description</p>
                }
                <h4>@article.Date.ToShortDateString() в @article.Date.ToShortTimeString()</h4>
                <a href="/news/detail/@article.Id" @*onclick="showDetails(@article.Id, this);"*@ id="more">Подробнее</a>
                @*<p id="newsHidden_@article.Id" style="display:none">@article.Description</p>*@
            </div>
        </div>
    }

    <div class="morenews">
        <a href="~/news/index" id="more">Все новости</a>
    </div>
</div>
